<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-02-10 zo 12:25 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Da Frasi a Vettori</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Andrew" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>

<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous"> 
<link rel="stylesheet" href="css/mystyle.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<a id ="home" href = "index.html" >
<i class="fa fa-language"></i> </a> <a id ="archive" href = "archive.html" ><i class="fa fa-archive"></i>
 </a> <a id ="archive" href = "about.html" >
<i class="fa fa-address-book"></i></a><a id ="git" href = "https://github.com/andcarnivorous" >
<i class="fab fa-github"></i> </a> <a id ="rss" href = "feed.xml" ><i class="fa fa-rss"></i> 
<font color="black"></font></a>
</div>
<div id="content">
<h1 class="title">Da Frasi a Vettori</h1>
<p>
  In questo articolo saranno spiegati i concetti base di analisi dei testi e di una delle tecniche più comunemente usate in linguistica computazionale ed NLP.
<br>
    <div class="figure" align="center">
      <img src="https://memegenerator.net/img/instances/72705299/come-and-do-nlp-join-the-dark-side.jpg">
	</div>
</p>

<p>
Usando Scikitlearn in Python, verrà mostrato come la distanza e il coseno di similitudine possono essere calcolati da diverse frasi, per scoprire quali sono più simili e quali meno.
</p>

<div id="outline-container-org3e3e8fa" class="outline-2">
<h2 id="org3e3e8fa">Vettori</h2>
<div class="outline-text-2" id="text-org3e3e8fa">
<p>
Sarò molto breve e funzionalista nel descrivere i vettori, ma se siete interessati ulteriormente, un qualsiasi libro di algebra lineare può dare qualsiasi approfondimento cerchiate.
</p>

<p>
Per ora, un vettore non è altro che un segmento (o anche solo un punto ma per comodità è meglio definirli così adesso) con una <b>direzione</b> ed una <b>magnitudine</b> (o lunghezza).
</p>

<p>
Se volessimo disegnarlo in 3D, un vettore avrebbe quindi tre coordinate: <b>x</b>, <b>y</b> e <b>z</b>, e lo trascriveremmo così:
</p>

<p>
[4 2 5]
</p>

<p>
Ora come ora, questo è solo un punto, ma se tracciamo il segmento che dal punto di origine [0 0 0] arriva a [4 2 5], abbiamo il nostro vettore per intero (dovremmo anche mettere una freccetta per indicare la direzione, ma limitiamoci al minimo). 
</p>

<p>
Sarebbe quindi rappresentato in uno spazio 3D così:
</p>


<div class="figure">
<p><img src="./img/vettore.png" alt="vettore.png" />
</p>
</div>

<p>
Ottimo, immaginiamo adesso di avere tre vettori però, il secondo sarà  <b>B</b> = [6 4 2] ed il terzo <b>C</b> = [3,3,4]:
</p>


<div class="figure">
<p><img src="./img/vettori.png" alt="vettori.png" />
</p>
</div>

<p>
Per misurare la similitudine fra questi vettori, basterà usare la formula del coseno di similitudine. Con questa formula conosceremo il coseno dell'angolo fra due vettori e, quindi, quanto due vettori sono simili tra loro.
La formula è facilmente consultabile su wikipedia, si può benissimo calcolare a mano per questi vettori piccoli in 3D, ma per risparmiare un pò di tempo useremo la funzione <b>cosine<sub>similarity</sub></b> di Scikit-learn.
</p>
</div>
</div>

<div id="outline-container-org721fd9e" class="outline-2">
<h2 id="org721fd9e">Da frasi a vettori</h2>
<div class="outline-text-2" id="text-org721fd9e">
<p>
Ok, come si applica tutta questa roba alle parole?
</p>

<p>
Facile, prendiamo due frasi di tre parole come "<i>ciao bell'amico</i>" e "<i>ciao ciao bello</i>". Abbiamo due frasi, entrambe di tre parole, ed il totale di parole uniche è praticamente 3, cioè: bell, ciao, amic. Eliminiamo le desinenze per comodità, dato che dire "ciao amico" e "ciao amica" non è poi così differente.
</p>

<p>
fatto ciò, possiamo creare una tabella dove ogni colonna corrisponde ad una delle parole (avremo quindi tre colonne) ed ogni riga corrisponde ad una frase (abbiamo due frasi, quindi due righe).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>FRASI</b></td>
<td class="org-right">ciao</td>
<td class="org-right">bell</td>
<td class="org-right">amic</td>
</tr>

<tr>
<td class="org-left">frase1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">frase2</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<p>
Come possiamo notare, ogni casella corrisponderà al numero di volte che una parola appare in una frase. Aggiungiamo una terza frase "bello bello!", la punteggiatura così come il genere non ci serve, ed avremo la frase3:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>FRASI</b></td>
<td class="org-right">ciao</td>
<td class="org-right">bell</td>
<td class="org-right">amic</td>
</tr>

<tr>
<td class="org-left">frase1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-left">frase2</td>
<td class="org-right">2</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">frase3</td>
<td class="org-right">0</td>
<td class="org-right">2</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>

<p>
Abbiamo tre vettori, ogni riga è un vettore e possiamo dire che <b>ciao</b>, <b>bell</b> e <b>amic</b> = <b>x</b>, <b>y</b> e <b>z</b>. Inoltre, proprio come prima, sono diversi tra loro. La domanda è: Quanto diversi fra loro?
</p>

<p>
Questa tabella è l'equivalente di una matrice, quindi, dove ogni riga corrisponde ad un vettore in 3D e possiamo aggiungere altre frasi che contengano solo queste tre parole, in qualsiasi ordine e quantità, per avere nuovi vettori 3D.
</p>


<div class="figure">
<p><img src="./img/matriceparole.png" alt="matriceparole.png" />
</p>
</div>

<p>
Vediamo però, adesso, con questi tre vettori quale è la situazione visivamente.
</p>
</div>
</div>

<div id="outline-container-org135f4b2" class="outline-2">
<h2 id="org135f4b2">Usando Python</h2>
<div class="outline-text-2" id="text-org135f4b2">
<p>
Per questo lavoro ci servono matplotlib, numpy e sklearn. Importiamoli quindi per prima cosa e poi mettiamo ogni frase in una variabile.
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">per plottare in 3D</span>
<span style="color: #fb4933;">import</span> matplotlib.pyplot <span style="color: #fb4933;">as</span> plt
<span style="color: #fb4933;">from</span> mpl_toolkits.mplot3d <span style="color: #fb4933;">import</span> Axes3D

<span style="color: #fb4933;">import</span> numpy <span style="color: #fb4933;">as</span> np

<span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">per trasformare le parole in vettori come nella precedente matrice.</span>
<span style="color: #fb4933;">from</span> sklearn.feature_extraction.text <span style="color: #fb4933;">import</span> CountVectorizer
<span style="color: #fb4933;">from</span> sklearn.metrics.pairwise <span style="color: #fb4933;">import</span> cosine_similarity

<span style="color: #83a598;">a</span> = <span style="color: #b8bb26;">"ciao bell amic"</span>
<span style="color: #83a598;">b</span> = <span style="color: #b8bb26;">"ciao ciao bell"</span>
<span style="color: #83a598;">c</span> = <span style="color: #b8bb26;">"bell bell"</span>

</pre>
</div>

<p>
Adesso, creiamo una lista contenente le frasi, creiamo un'istanza del CountVectorizer e diamogli le nostre frasi da trasformare nella matrice mostrata prima.
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="color: #83a598;">phrases</span> = <span style="color: #458588;">[</span>a,b,c<span style="color: #458588;">]</span>

<span style="color: #83a598;">cv</span> = CountVectorizer<span style="color: #458588;">()</span>

<span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">diamo al CountVectorizer le frasi da rendere in vettori</span>
<span style="color: #83a598;">fitted</span> = cv.fit_transform<span style="color: #458588;">(</span>phrases<span style="color: #458588;">)</span>

<span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">dobbiamo convertire l'oggetto in un array per poterlo visualizzare e sfruttare meglio</span>
<span style="color: #83a598;">matrice</span> = fitted.toarray<span style="color: #458588;">()</span>

</pre>
</div>

<p>
Se, nella console di python decidessimo di vedere la variabile <b>matrice</b>, ci sarà ritornato questo:
</p>

<p>
<code>array([[1, 1, 1],       [0, 1, 2],       [0, 2, 0]], dtype=int64)</code>
</p>

<p>
Questa è la nostra matrice di prima, ogni sua riga è uno dei vettori ed ogni vettore è una delle frasi.
</p>

<p>
Ok, adesso cerchiamo di plottare questi vettori. Potremmo ovviamente inserire i valori di ogni vettore manualmente e singolarmente. Sarebbe facile visto che sono solo 3 valori per vettore e per di più numeri simili, ma cerchiamo di rendere la cosa più flessibile così che dopo potremo usare il codice con altre nuove frasi senza dover far troppo manualmente.
</p>

<div class="org-src-container">
<pre class="src src-python">
<span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">creiamo una figura con matplotlib, sar&#224; in 3D</span>
<span > </span> <span style="color: #83a598;">fig</span> = plt.figure<span style="color: #458588;">()</span>
<span > </span> <span style="color: #83a598;">ax</span> = fig.add_subplot<span style="color: #458588;">(</span>111, projection=<span style="color: #b8bb26;">'3d'</span><span style="color: #458588;">)</span>

<span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">adesso andremo attraverso ogni vettore nella matrice, per ogni vettore</span>
<span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">useremo il primo valore come x, il secondo come y ed il terzo come z</span>
<span > </span> <span style="color: #fb4933;">for</span> x <span style="color: #fb4933;">in</span> <span style="color: #fe8019;">range</span><span style="color: #458588;">(</span><span style="color: #fe8019;">len</span><span style="color: #b16286;">(</span>matrice<span style="color: #b16286;">)</span><span style="color: #458588;">)</span>:
<span > </span>   <span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">questo metter&#224; ogni punto sul piano.</span>
<span > </span>   <span > </span> ax.scatter<span style="color: #458588;">(</span>matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>0<span style="color: #b16286;">]</span>, matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>1<span style="color: #b16286;">]</span>, matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>2<span style="color: #b16286;">]</span><span style="color: #458588;">)</span>

<span > </span>   <span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">se vogliamo, possiamo scrivere la frase vicina al punto per orientarci</span>
<span > </span>   <span > </span> ax.text<span style="color: #458588;">(</span>matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>0<span style="color: #b16286;">]</span>, matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>1<span style="color: #b16286;">]</span>, matrice<span style="color: #b16286;">[</span>x<span style="color: #b16286;">][</span>2<span style="color: #b16286;">]</span>,
              phrases<span style="color: #b16286;">[</span>x<span style="color: #b16286;">]</span><span style="color: #458588;">)</span>

<span > </span>   <span > </span> <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">con questo disegneremo una linea dal punto 0 ad ogni vettore.</span>
<span > </span>   <span > </span> ax.plot<span style="color: #458588;">(</span><span style="color: #b16286;">[</span>0, matrice<span style="color: #8ec07c;">[</span>x<span style="color: #8ec07c;">][</span>0<span style="color: #8ec07c;">]</span><span style="color: #b16286;">]</span>,<span style="color: #b16286;">[</span>0, matrice<span style="color: #8ec07c;">[</span>x<span style="color: #8ec07c;">][</span>1<span style="color: #8ec07c;">]</span><span style="color: #b16286;">]</span>,<span style="color: #b16286;">[</span>0, matrice<span style="color: #8ec07c;">[</span>x<span style="color: #8ec07c;">][</span>2<span style="color: #8ec07c;">]</span><span style="color: #b16286;">]</span><span style="color: #458588;">)</span>

plt.show<span style="color: #458588;">()</span>
</pre>
</div>

<p>
Avremo, come risultato, un grafico 3D simile al seguente, che potremo ruotare come preferiamo.
</p>


<div class="figure">
<p><img src="./img/parolevettori3.png" alt="parolevettori3.png" />
</p>
</div>

<p>
Chiaramente le frasi sembrano distanti fra loro, ma quali sono più o meno simili?
</p>

<p>
per calcolarlo, usiamo adesso la funzione di scikitlearn e vediamo di ottenere il coseno di similitudine per ogni coppia:
</p>


<div class="org-src-container">
<pre class="src src-python">
<span style="color: #83a598;">counter</span> = 0
<span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">iteriamo attraverso ogni vettore della matrice, aka ogni frase</span>
<span style="color: #fb4933;">while</span> counter &lt; <span style="color: #fe8019;">len</span><span style="color: #458588;">(</span>matrice<span style="color: #458588;">)</span>-1:

<span > </span>   <span style="color: #7c6f64;"># </span><span style="color: #7c6f64;">otteniamo il coseno di similitudine fra la frase corrente e quella successiva e precedente    </span>
<span > </span>   <span style="color: #fb4933;">print</span><span style="color: #458588;">(</span><span style="color: #b8bb26;">"Similarity between:"</span>, phrases<span style="color: #b16286;">[</span>counter<span style="color: #b16286;">]</span>, <span style="color: #b8bb26;">" : "</span>, phrases<span style="color: #b16286;">[</span>counter+1<span style="color: #b16286;">]</span><span style="color: #458588;">)</span>
<span > </span>   <span style="color: #fb4933;">print</span><span style="color: #458588;">(</span>cosine_similarity<span style="color: #b16286;">(</span><span style="color: #8ec07c;">[</span>matrice<span style="color: #d65d0e;">[</span>counter<span style="color: #d65d0e;">]</span><span style="color: #8ec07c;">]</span>, <span style="color: #8ec07c;">[</span>matrice<span style="color: #d65d0e;">[</span>counter+1<span style="color: #d65d0e;">]</span><span style="color: #8ec07c;">]</span><span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
<span > </span>   <span style="color: #fb4933;">print</span><span style="color: #458588;">(</span><span style="color: #b8bb26;">"Similarity between:"</span>, phrases<span style="color: #b16286;">[</span>counter<span style="color: #b16286;">]</span>, <span style="color: #b8bb26;">" : "</span>, phrases<span style="color: #b16286;">[</span>counter-1<span style="color: #b16286;">]</span><span style="color: #458588;">)</span>
<span > </span>   <span style="color: #fb4933;">print</span><span style="color: #458588;">(</span>cosine_similarity<span style="color: #b16286;">(</span><span style="color: #8ec07c;">[</span>matrice<span style="color: #d65d0e;">[</span>counter<span style="color: #d65d0e;">]</span><span style="color: #8ec07c;">]</span>, <span style="color: #8ec07c;">[</span>matrice<span style="color: #d65d0e;">[</span>counter-1<span style="color: #d65d0e;">]</span><span style="color: #8ec07c;">]</span><span style="color: #b16286;">)</span><span style="color: #458588;">)</span>
<span> </span>   <span style="color: #83a598;">counter</span> += 1

</pre>
</div>

<p>
Avremo dei doppioni nei risultati, ma è il metodo più veloce per ottenere i risultati in modo facilmente replicabile con nuove frasi.
</p>

<p>
Se eseguiamo nuovamente il codice, vedremo che per le nostre frasi:
</p>

<pre class="example">

Similarity between: ciao bell amic  :  ciao ciao bell
0.77459667
Similarity between: ciao bell amic  :  bell bell
0.57735027
Similarity between: ciao ciao bell  :  bell bell
0.4472136
Similarity between: ciao ciao bell  :  ciao bell amic
0.77459667

</pre>

<p>
Le frasi più simili sono "ciao bell amic" e "ciao ciao bell", mentre le meno simili sono "ciao ciao bell" e "bell bell"
</p>

<p>
Proviamo ad aggiungere "ciao ciao" come frase e vediamo che risultato abbiamo.
</p>


<div class="figure">
<p><img src="./img/parolevettori4.png" alt="parolevettori4.png" />
</p>
</div>

<p>
Già dall'immagine qualcosa è intuibile.
</p>


<pre class="example">

Similarity between: ciao bell amic  :  ciao ciao bell
0.77459667
Similarity between: ciao bell amic  :  ciao ciao
0.57735027
Similarity between: ciao ciao bell  :  bell bell
0.4472136
Similarity between: ciao ciao bell  :  ciao bell amic
0.77459667
Similarity between: bell bell  :  ciao ciao
0.
Similarity between: bell bell  :  ciao ciao bell
0.4472136

</pre>

<p>
Possiamo anche salvare il nostro grafico, volendo, in formato gif come animazione:
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="color: #fb4933;">def</span> <span style="color: #fabd2f;">rotate</span><span style="color: #458588;">(</span>angle<span style="color: #458588;">)</span>:
<span> </span>   ax.view_init<span style="color: #458588;">(</span>azim=angle<span style="color: #458588;">)</span>

<span style="color: #83a598;">line_ani</span> = animation.FuncAnimation<span style="color: #458588;">(</span>fig, rotate, interval=50<span style="color: #458588;">)</span>
line_ani.save<span style="color: #458588;">(</span><span style="color: #b8bb26;">'rotation.gif'</span>, dpi=90, writer=<span style="color: #b8bb26;">'imagemagick'</span><span style="color: #458588;">)</span>

</pre>
</div>


<div class="figure">
<p><img src="./img/rotation2.gif" alt="rotation2.gif" />
</p>
</div>

<p>
Shwifty
</p>
</div>
</div>

<div id="outline-container-orga8ff06e" class="outline-2">
<h2 id="orga8ff06e">Conclusione</h2>
<div class="outline-text-2" id="text-orga8ff06e">
<p>
Provate ad aggiungere altre combinazioni, magari anche ripetendo "ciao" solo 10 volte per vedere quale il risultato del cosine similarity sarà.
</p>

<p>
Quando però immaginiamo di usare questo metodo su un libro ad esempio, avremo vettori di n dimensioni, dove n è uguale al numero di parole uniche in tutti i libri messi insieme.
</p>

<p>
Ovviamente noi possiamo vedere e rappresentare direttamente solo in 3D (e neanche così bene alle volte), e immaginare un vettore di 5 mila dimensioni non è esattamente facile, ma le formule come quella del coseno di similitudine possono ancora essere applicate, il solo aggiungere una quarta parola diversa al nostro esempio di oggi rende impossibile rappresentare direttamente i vettori di 4 dimensioni risultanti.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<div>
<script src="https://utteranc.es/client.js"
        repo="andcarnivorous/andcarnivorous.github.io"
        issue-term="title"
        crossorigin="anonymous"
        async>
</script>
</div>
<p class="date">Date: 2019-02-10 zo 00:00</p>
<p class="author"> Author: Andrew</p>
<a href = "archive.html" >Other posts</a>
</div>
</body>
</html>
